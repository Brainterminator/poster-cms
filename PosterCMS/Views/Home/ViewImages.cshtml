@model List<string>
@{
    var baseUrl = $"{Context.Request.Scheme}://{Context.Request.Host}/uploads/";
    Layout = "Modal.cshtml";
}

<h1>Uploaded Images</h1>

@if (Model.Count == 0)
{
    <p>No images uploaded yet.</p>
}
else
{
    <section class="poster-grid image-grid">
        <a class="button add-poster" asp-area="" asp-controller="Home" asp-action="ImageUploader">+</a>
        @foreach (var fileName in Model)
        {
            var imageUrl = baseUrl + fileName;
            <article class="poster-preview">
                <a href="@Url.Action("DeleteImage", "Home", new { path = "uploads/" + fileName })"><img class="rm-img-btn"
                        src="/icons/delete.svg"></a>
                <img src="@imageUrl" onclick="selectImage('@imageUrl')" style="cursor: pointer;">
                <div class="poster-labels">
                    <p class="img-name">@fileName</p>
                    <div class="cpy-btn" onclick="copyToClipboard('@imageUrl')">
                        <p>Copy</p>
                        <img src="/icons/copy.svg" class="cpy-btn-svg"></img>
                    </div>
                </div>
            </article>
        }
    </section>
}

@section Scripts {
    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                console.log("Copied to clipboard!");
            }, (err) => {
                alert("Failed to copy: " + err);
            });
        }
        function selectImage(url) {
            if (window.parent && window.parent.setImageUrl) {
                window.parent.setImageUrl(url);
            }
        }
    </script>
}
